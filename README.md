# 🎨 Dreamina 自动化图片生成工具 v3.0

一个专业的AI图片自动化生成工具，基于图形化界面，支持从Excel表格批量读取提示词并自动生成高质量AI图片。

## ✨ 主要特性

### 🖥️ 图形化界面
- **直观易用**：完全基于PyQt6的现代化GUI界面
- **配置管理**：可视化配置浏览器、路径、模型等参数
- **实时监控**：任务进度和状态实时显示

### 🖼️ 智能图片生成
- **批量处理**：从Excel文件批量读取提示词
- **多窗口并行**：支持多浏览器窗口同时生成，提高效率
- **断点续传**：自动跳过已处理的提示词，支持中断后继续
- **多格式支持**：自动转换为JPG格式，优化存储

### 💰 积分智能管理
- **实时监控**：自动检测账户积分余额
- **智能暂停**：积分不足时自动暂停任务
- **负载均衡**：多窗口模式下智能分配任务

### 📁 项目化管理
- **独立存储**：每个项目的图片独立保存在对应文件夹
- **灵活配置**：支持多种图片尺寸和AI模型选择
- **状态跟踪**：Excel文件自动标记处理状态

## 🚀 快速开始

### 环境要求
- Python 3.8+
- Bit Browser（比特浏览器）
- Windows/macOS/Linux

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd rpa-dreamina
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **安装Playwright浏览器**
```bash
playwright install chromium
```

4. **启动程序**
```bash
python main.py
```

## 📋 使用指南

### 1. 界面配置

#### 🌐 浏览器设置
- 添加比特浏览器的环境ID
- 支持单窗口或多窗口并行模式
- 每个窗口独立处理任务

#### 📁 路径设置
- 设置项目根目录（包含各项目子文件夹）
- 每个子文件夹应包含对应项目的Excel文件

#### 🖼️ 图片设置
- **默认模型**：选择AI图片生成模型（Image 3.0推荐）
- **默认尺寸**：设置图片比例（9:16, 16:9, 1:1等）

#### 📊 Excel设置
- **提示词列**：Excel中包含提示词的列号
- **状态列**：用于标记处理状态的列号
- **开始行**：数据开始的行号
- **状态文本**：完成后的标记文本

#### 💰 积分监控
- 启用积分实时监控
- 设置最小积分阈值

### 2. 文件结构

```
Projects/                    # 根目录
├── 项目A/                   # 项目文件夹
│   ├── prompts.xlsx        # 提示词Excel文件
│   └── generated_images/   # 生成的图片(自动创建)
├── 项目B/
│   ├── tasks.xlsx
│   └── generated_images/
└── ...
```

### 3. Excel格式要求

| A列 | B列(提示词) | C列 | D列(状态) |
|-----|-------------|-----|-----------|
| 1   | 美丽的风景画 | ... | 已生成图片 |
| 2   | 可爱的小猫  | ... |           |

- 提示词列：包含AI绘画提示词
- 状态列：程序会自动标记"已生成图片"

## ⚙️ 高级功能

### 🚀 多窗口并行处理
- 配置多个浏览器ID实现并行处理
- 自动任务分配和负载均衡
- 单独的积分监控和错误处理

### 💡 智能重试机制
- 网络错误自动重试
- SSL连接问题智能处理
- 页面异常自动恢复

### 📥 高效下载
- HTTP直接下载图片
- 多重SSL配置尝试
- 图片格式自动转换

## 🔧 配置文件

程序会自动创建配置文件：
- `gui_config.json`：主要配置文件
- `dreamina_elements.json`：页面元素配置文件

所有配置都通过图形界面进行管理，无需手动编辑配置文件。

## 📝 更新日志

### v3.0 - 2024最新版
- ✨ 全新GUI界面，操作更直观
- 🚀 多窗口并行处理，效率大幅提升
- 💰 积分智能监控，避免账户异常
- 🔄 增强错误处理和重试机制
- 📁 项目化管理，文件组织更清晰
- 🖼️ 支持多种图片模型和尺寸

## ❓ 常见问题

### Q: 如何添加浏览器ID？
A: 在GUI界面的"浏览器设置"区域点击"添加浏览器ID"按钮，输入比特浏览器的环境ID。

### Q: 图片保存在哪里？
A: 图片会保存在对应项目文件夹下的`generated_images`子文件夹中。

### Q: 如何设置多窗口并行？
A: 添加多个浏览器ID即可自动启用多窗口模式，程序会智能分配任务。

### Q: 积分不足怎么办？
A: 程序会自动检测积分，不足时暂停处理。请及时充值后重新启动任务。

## 📄 许可证

本项目仅供学习和研究使用，请遵守相关平台的使用条款。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

---

**注意**：使用本工具时请遵守Dreamina平台的使用协议，合理使用资源，避免过于频繁的请求。 